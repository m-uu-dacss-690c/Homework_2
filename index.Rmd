---
title: "Homework 2: Networks"
output: html_document
date: "2026-01-03"
author: Marcus Widitor
---

## 1. Re read the graph from GitHub (cloud)

```{r setup, warning=FALSE, message=FALSE}
library(igraph)
library(ggraph)
library(tidyverse)
library(ggrepel) #to avoid overlapping text labels in graphs
set.seed(1111)
actors=read_graph("https://raw.githubusercontent.com/m-uu-dacss-690c/Homework_2/refs/heads/main/hollywood.graphml",format='graphml')
```

```{r view-graph}
ggraph(graph = actors) +
  geom_edge_link(
    aes(label = weight), # Use weight for both label and width
    alpha = 0.5,
    label_size = 2.5,
    angle_calc = 'along' # Optional: Draws the label along the edge line
  ) +
  geom_node_text(
    aes(label = name, color = as.factor(wonOscar)),
    repel = TRUE
  ) +
  scale_color_manual(values = c('red', 'blue')) +
  theme_graph()
```

## 2. Compute node central measures: eigen_centrality, closeness, betweenness.

```{r central-measures-computation}
central_measures <- tibble(
  name = V(actors)$name,
  eigen_centrality = eigen_centrality(actors)$vector, 
  closeness = closeness(actors, normalized = TRUE),
  betweenness = betweenness(actors, normalized = TRUE)
)
central_measures
```

## 3. Prepare a correlation plot with previous measures, and comment the result.

```{r central-measure-graph}
graph <- ggplot(central_measures, 
                aes(x=betweenness, y=closeness, size=eigen_centrality, label = name)) + 
  geom_point() +
  geom_text_repel() +
  scale_y_continuous(limits = c(0, NA)) +
  labs(title = "Actor Network Measures of Centrality")
graph

```

Betweenness and closeness seem to be positively correlated, but eigen centrality doesn't appear to have a relationship with the other central measures. Despite having the lowest closeness and betweenness values, Al Pacino and Robert DeNiro both have large values of eigen centrality.

## 4. Is it possible communities are present? Support your answer with computations.

```{r communities}
# function to output a single transitivity rate based on a randomly generated network
transitivity_rate <- function(a){
  random_graph = sample_gnp(length(V(a)),p=edge_density(a))
  tr = transitivity(a)/transitivity(random_graph)
  if (is.finite(tr)) {
    tr
  }
  else
    NA
}
# average thousands of calculated rates
transitivity_rates <- map_dbl((1:3001), ~ transitivity_rate(actors)) |>
  enframe(name = NULL, value = "transitivity_rate") 
transitivity_rates |>
  summarize("mean transitivity rate" = mean(transitivity_rate, na.rm = TRUE))
```

With transitivity being how likely two nodes with a common connection are connected, since the average transitivity rate is above one (around 1.13), then it is possible communities are present.

## 5. IF the presence of communities is possible, compute the communities using Girvan-Newman and Louvain algorithms. Plot the best result.

```{r}
# Girvan-Newman communities

# Membership vector will be selected based on the highest modularity score
partition_girvanNewman_best <- cluster_edge_betweenness(actors)
# add community column 
V(actors)$girvanNewman_community=as.factor(membership(partition_girvanNewman_best))

girvan_newman_graph <- ggraph(graph = actors,layout = 'fr') +
  geom_edge_link(alpha=0.2) +
  geom_node_point(aes(color=girvanNewman_community), show.legend = TRUE, size=4) +
  geom_node_text(aes(label = name), repel = TRUE) +
  labs(title = "Girvan-Newman Communities in Actor Network")
girvan_newman_graph

```

```{r}
# Louvain communities

# Membership vector will be selected based on the highest modularity score
partition_louvain_optimal <- cluster_louvain(actors)
# add community column
V(actors)$louvain_community=as.factor(membership(partition_louvain_optimal))

louvain_graph <- ggraph(graph = actors,layout = 'fr') +
  geom_edge_link(alpha=0.2) +
  geom_node_point(aes(color=louvain_community), show.legend = TRUE, size=4) +
  geom_node_text(aes(label = name), repel = TRUE) +
  labs(title = "Louvain Communities in Actor Network")
louvain_graph

```
